$(document).ready(function(){var e=$("#visc-holder"),t=$("#add_field");const l=(e,t,l)=>l.indexOf(e)===t;function r(e){for(var t=0;t<e.length;t++){if(!$.isNumeric(e[t]))return 0;if(e[t]=parseFloat(e[t]),e[t]<=0)return-1}return e}function s(e){if(!e)return-2;for(var t=0;t<e.length;t++){if(!$.isNumeric(e[t]))return 0;if(e[t]=parseFloat(e[t]),e[t]>0)return-1}return e}function i(e,t,l){var r="";return 0==e&&(r+="<li>"+l+" test temperatures should be numeric</li>"),-1==e&&(r+="<li>"+l+" test temperatures should be positive</li>"),0==t&&(r+="<li>"+l+" DSR value should be numeric</li>"),-1==t&&(r+="<li>"+l+" DSR value should be positive</li>"),t.length!=e.length&&0!=t&&-1!=t&&0!=e&&-1!=e&&void 0!==e.length&&void 0!==t.length&&(r+="<li>Number of "+l+" test temperature and number of "+l+" DSR values should be same\nYou provided "+e.length+" temperatures and "+t.length+" DSR values</li>"),r}function n(e,t){var l="";return-1==e?l+="<li>"+t+" should be a positive number</li>":0==e&&(l+="<li>"+t+" should be a numeric value</li>"),l}function u(e,t,l){var r=[],s=0;if("lt"==t)for(var i=0;i<e.length;i++)e[i]<l&&(r[s]=i,s++);else if("gt"==t)for(i=0;i<e.length;i++)e[i]>l&&(r[s]=i,s++);return r}function a(e,t){for(var l=[],r=0;r<e.length;r++)l[r]=t[e[r]];return l}var o=1;$(t).click(function(t){t.preventDefault(),function(e,t,l,r,s){l<r&&$(e).append('<input name="'+t+o+'" type="text" id="'+t+o+'" placeholder="'+s+'" class = "calc" value="">')}(e,"visc",o++,5,"Viscosity at 135&#8451")}),$("#pg-calc").click(function(){$("#result").hide("fast"),$("#result-error").hide("fast");var e="Error List:<br/><ol>",t=$("#flp").val(),o=$("#visc1").val(),h=$("#temp-ds1-1").val().split(","),d=$("#ds1-1").val().split(","),v=$("#temp-ds2-1").val().split(","),f=$("#ds2-1").val().split(","),m=$("#temp-ds3-1").val().split(","),p=$("#ds3-1").val().split(","),c=$("#temp-cs-1").val().split(","),g=$("#s-1").val().split(","),b=$("#m-1").val().split(","),D=$("#temp-dt-1").val().split(","),F=$("#dt-1").val().split(",");if(t=r(parseFloat(t)),o=r(parseFloat(o)),h=r(h),d=r(d),v=r(v),f=r(f),m=r(m),p=r(p),c=s(c),g=r(g),b=r(b),D=s(D),F=r(F),e+=n(t,"Flash Point Temperature"),e+=n(o,"Viscosity"),e+=i(h,d,"Original Binder"),e+=i(v,f,"RTFO"),e+=i(m,p,"PAV"),0==c&&(e+="<li>Creep Stiffness test temperatures should be numeric</li>"),-1==c&&(e+="<li>Creep Stiffness test temperatures should be Negative</li>"),0==g&&(e+="<li>S-values should be numeric</li>"),-1==g&&(e+="<li>m-values should be positive</li>"),0==b&&(e+="<li>m-values should be numeric</li>"),-1==b&&(e+="<li>S-values should be positive</li>"),0!=g&&-1!=g&&0!=c&&-1!=c&&0!=b&&-1!=b&&void 0!==b.length&&void 0!==g.length&&(g.length==c.length&&c.length==b.length||(e+="<li>Number of Creep stiffness test temperatures and number of s and m values should be same\nYou provided "+c.length+" temperatures and "+g.length+" s-values and "+b.length+" m-values</li>")),0==D&&(e+="<li>Direct Tension test temperatures should be numeric</li>"),-1==D&&(e+="<li>Direct Tension test temperatures should be Negative</li>"),0==F&&(e+="<li>Direct Tension test results should be numeric</li>"),-1==g&&(e+="<li>Direct tension test values should be positive</li>"),0!=F&&0!=D&&void 0!==F.length&&void 0!==D.length&&F.length!=D.length&&(e+="Number of Direct Tension test temperatures and number of Direct Tension results should be same.\nYou provided "+D.length+" temperatures and "+F.length+" Direct tension values\n"),"Error List:<br/><ol>"!=e)$("#result-error").html("<h4>"+e+"</ol></h4>"),$("#result-error").show("fast");else{var w="";if(t<230)w+="Failed in Flash point temperature",$("#result-error").html("<h4>"+w+"</h4>"),$("#result-error").show("fast");else if(o>3)w+="Failed in viscosity at 135&#8451",$("#result-error").html("<h4>"+w+"</h4>"),$("#result-error").show("fast");else{var S=u(d,"gt",1),N=u(f,"gt",2.2),T=u(p,"lt",5e3),P=function(e,t,r,s,i){for(var n=[],u=0,a=0;a<e.length;a++)if(e[a]<300&&e[a]>.3)n[u]=a,u++;else if(e[a]>300&&e[a]<600&&t[a]>.3&&-2!=s&&-2!=i)for(var o=0;o<i.length;o++)i[o]>1&&(n[u]=a,u++);return n.filter(l)}(g,b,0,D,F),y=a(S,h),R=a(N,v),x=a(T,m),C=a(P,c),G=_.intersection(y,R),O=function(e,t){for(var r=0,s=[],i=0;i<e.length;i++)for(var n=0;n<t.length;n++)s[r]=(e[i]+t[n]-10)/2+4,r++;return s.filter(l)}(G,C),V=_.intersection(O,x),Y=_.max(G),k=Y-2*(_.max(V)-4);Y?k?($("#result").html('<h4>Provided data matches best with <span class="result">PG '+Y+"-"+k+"</span></h4>"),$("#result").show("fast")):(w+="Unsuccessful in determining PG low temp\n",$("#result-error").html("<h4>"+w+"</h4>"),$("#result-error").show("fast")):(w+="Unsuccessful in determining PG high temp",$("#result-error").html("<h4>"+w+"</ol></h4>"),$("#result-error").show("fast"))}}})});